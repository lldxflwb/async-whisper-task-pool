---
alwaysApply: true
---

项目 whisper api

用于部署在auto-dl 这种平台，执行异步的whisper识别任务

有一个任务池，任务池用来缓存任务
有一个结果池，结果池用来缓存结果

每一个任务对应一个缓存文件，缓存文件是一个加密压缩的zip文件，包含了提交任务的metadata

metadata中 包含 相对于任务提交方的任务id（uuid），任务提交方的文件地址，解压密码,使用的模型

任务池数量有限制，可以通过环境变量配置。默认为5个

对外暴露接口：
    - 任务池是否满
    - 提交任务到任务池
    - 获取任务结果
    - 获取任务状态
    - 清楚任务信息（包含转录的字幕内容）

交互流程如下：
客户端通过form表单，将压缩包和文件信息提交到服务器，服务器将其放入到任务池，返回ok（任务id在客户端生成，使用uuid，如果相同，新的覆盖旧的）

客户端通过轮询，获取任务结果（srtw文件），如果任务完成，则返回结果，否则返回空

服务的通告任务池单线程执行转录任务，任务执行完成后，将结果放入到结果池，并删除任务池中的任务，并删除压缩文件，音频文件。

压缩包中的音频文件格式为 ogg 统一名称为 audio.ogg


使用语言 python3.12